<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
	    <title>NCBS 25</title>
	    <link rel="icon" href="img/Assets/ncbs_logo_header.png" type="image/png" sizes="16x16">
	    <meta name="description" content="" />
	    <meta name="author" content="" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="libs/font-awesome-4.6.3/css/font-awesome.min.css">
		<link type="text/css" rel="stylesheet" href="css/bootstrap.css" />
		<link type="text/css" rel="stylesheet" href="css/theme/header.css" />
		<link type="text/css" rel="stylesheet" href="css/theme/main.css">
		<link type="text/css" rel="stylesheet" href="libs/ImageViewer-master/imageviewer.css" />
		<style>
		.global-audio-player{
			position:fixed;
			bottom:0px;
			width: 100%;
			background-color: white;
			height: 50px;
		}
		</style>
	</head>

	<body>
	

	<div class="container-fluid">
		<div class="row-fluid">
			<!-- Header from templates/header.html and app.js -->
				<div id="header">
				</div>
			
		</div>
		<div class="row-fluid">
			<div class="">
				<div id="main">
					<div id="spinner-launch" style="display:none;">
						<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
						<span class="sr-only">Loading...</span>
					</div>
					<div id="content">

					</div>
				</div>
			</div>
		</div>
			
		<div class="row-fluid">
			<div class="col-md-12">
				<!-- footer which is a common navigation to themes-->
				<div id="footer">
				</div>
			</div>
		</div>	

	<div id="audio-player-container">
	</div>
	</div>

    <!-- testing components markup  end-->


    <!-- Templates and scripts start -->

   <script type="text/template" id="dummy-view">
   <div class="container" style="background-color:#f4f3e9; height:600px;" id="ncbs-narrative-container">
   <div class="panel panel-default" style="top:150px;position:relative;">
     <div class="panel-body">
     <div class="center-block">
       <h1> Coming soon! </h1>
       </div>
     </div>
   </div>
   
   </div>
   </script>
	    <script type="text/template" id="listItems">
		
			<div class="list-group-item">
				  
					<%if(mime_type == "audio/mpeg"){%> 
						<audio controls="controls" preload="none">
						                  Your browser does not support the <code>audio</code> element.
						                  
						                  <source src=<%= fileurls.original %>>
						                </audio>
						<%}%>
					<%if(mime_type == "image/jpeg"){%>
						<img data-high-res-src= <%= fileurls.fullsize %> src=<%= fileurls.thumbnail%> class="pannable-image"/>
						<%}%>

					<% if(description){%> 
						<p><%= description.text %></p>
					<%}%>
					<% if(rights){%> 
						<p><%= rights.text %></p>
					<%}%>
			</div>
		</script>
<!-- global audio player template -->
<script type="text/template" id="audio-player-template">
<div class="global-audio-player" >
<audio controls autoplay class="center-block" style="margin-top:10px; width:100%; padding-left: 15px; padding-right: 15px;">
  
  <source src="<%=original%>" type="audio/mpeg">
Your browser does not support the audio element.
</audio>
</div>
</script>

<!-- subtheme identity content start-->
<script type="text/template" id="img-slider-template">
<div class="col-md-12">
    <div class="image-container"></div>
    <span class="prev glyphicon glyphicon-chevron-left"/></span>
    <span  class="next glyphicon glyphicon-chevron-right"/></span>
    <div class="footer-info">
        <span class="current"></span>/<span class="total"></span>
    </div>
</div>    
</script>

<script type="text/template" id="sub-theme-nav-tabs">
<div class="container" style="background-color:#f4f3e9;" id="ncbs-narrative-container">


<!-- Nav tabs -->
  <ul class="nav nav-tabs" role="tablist" style="margin-top:125px">
  <% _.each(sitemap, function(arr,index) {%>

  <li role="presentation" class=""><a href="#<%=index%>-note" aria-controls="<%=index%>-note" role="tab" data-toggle="tab"><!--img src="img/Assets/identity.png" alt="category_identity" class="img-responsive" style="max-width:15px; display:inline;"/><span--><%=arr%><!--/span--></a></li>
  <%});%>
    
  </ul>

  <!-- Tab panes -->
  <div class="container tab-content">
  <% _.each(sitemap, function(arr,index) {%>
  	<%var i = index+1;%>
  <div role="tabpanel" class="tab-pane" id="<%=index%>-note">
  <%= content.element_texts[i].text %>
  
  </div>
  <%});%>
    
  </div>

	
</div>
</script>

<!-- subtheme identity content END-->
<!-- testing components end-->

	<script type="text/javascript" src="libs/underscore-1.5.2-min.js"></script>	    
	<script type="text/javascript" src="libs/jquery-1.10.2-min.js"></script>

	<script type="text/javascript" src="libs/backbone-1.1.0-min.js"></script>
	<script type="text/javascript" src="libs/classie.js"></script>
	<script type="text/javascript" src="libs/require.min.js"></script>	    		
	<script type="text/javascript" src="libs/bootstrap.min.js"></script>
	<script type="text/javascript" src="libs/ImageViewer-master/imageviewer.min.js"></script>


	<script type="text/javascript" src="js/views.js"></script>
	<script type="text/javascript" src="js/collections.js"></script>	
	<script type="text/javascript" src="router.js"></script>    		
	<script type="text/javascript" src="app.js"></script>
	<script>
		app = {};
		// Site content from omeka api as required by the client 
		//interfaces.
		storyCollection = Backbone.Collection.extend({
			groupByTags: function(index){
				return this.groupBy(function(item){
					console.log(index);
					return item.get('tags').name.split('-')[index];
				}, index);
			}
		});
		APIcontent = new storyCollection;
		app.controller = AppController();
		console.log(app);
		app.init = function() {
			app = new ApplicationRouter();
			app.state={};
			Backbone.history.start();

		};
		$("#spinner-launch").show();
		//app.init();
		//hack - to call init a delay beacause some view components 
		//are undefined in the runtime on the server
		setTimeout(app.init, 5000);
		
	</script>

	

	</body>
</html>